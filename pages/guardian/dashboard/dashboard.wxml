<!--pages/guardian/dashboard/dashboard.wxml-->
<view class="container">
  <view class="patient-selector">
    <scroll-view class="scroll-view" scroll-x scroll-with-animation>
  <block wx:for="{{patients}}" wx:key="id">
    
    <view 
      wx:if="{{item.type === 'add'}}"
      class="patient-item add-btn-item"
      bindtap="selectPatient" 
      data-item="{{item}}"
    >
      <view class="add-icon-wrapper">
        <text class="add-icon">+</text>
      </view>
      <text class="name">{{item.name}}</text>
    </view>
    
    <view 
      wx:else
      class="patient-item {{item.id === selectedPatientId ? 'active' : ''}}"
      bindtap="selectPatient"
      data-item="{{item}}"
    >
      <image class="avatar" src="{{item.avatar}}" mode="aspectFill"></image>
      <text class="name">{{item.name}}</text>
    </view>
    
  </block>
</scroll-view>
  </view>

  <view class="content-area" style="height: 1074rpx; display: block; box-sizing: border-box">
    <view class="section-title" style="position: relative; left: 0rpx; top: 16rpx">安全设置</view>
    
    <view class="empty-tip" wx:if="{{safetyData[selectedPatientId].length === 0}}">
      <image class="empty-icon" src="/images/empty.png"></image>
      <text>暂未给 {{selectedPatientName}} 设置安全区域或路线</text>
      <text class="sub-tip">点击右下角按钮开始添加吧</text>
    </view>

    <view class="card" wx:for="{{safetyData[selectedPatientId]}}" wx:key="index" style="position: relative; left: 0rpx; top: 31rpx">
      <view class="card-header">
        <image class="card-icon" src="{{item.type === 'zone' ? '/images/zone.png' : '/images/route.png'}}"></image>
        <text class="card-title">{{item.name}}</text>
      </view>
      <view class="card-body">
        <text class="card-desc">{{item.description}}</text>
      </view>
      <view class="card-actions">
        <view class="action-btn edit">编辑</view>
        <view class="action-btn delete">删除</view>
      </view>
    </view>
  </view>

  <view class="fab-btn" bindtap="addSetting">
    <text class="icon">+</text>
  </view>

</view>